enable 
config t 
hostname <location-routernum> 
banner motd # <message> # 
no ip domain lookup 
ip routing 
ipv6 unicast-routing
security passwords min-length <num-8> 
service password-encryption 
enable algorithm-type sha256 secret <en-pass> 
username <name-Admin> algorithm-type scrypt secret <pass>
line vty 0 4 
exec-timeout 2 0 
login local 
transport input ssh 
exit 
line aux 0 
login local 
exit 
line console 0 
exec-timeout 3 30 
login local 
logging synchronous 
exit 
! 
login block-for <seconds> attempts <tries> within <seconds>
ip access-list standard <aclname- PERMIT-ADMIN> 
permit <admin-ip-address> 
exit 
login quiet-mode access-class <above- PERMIT-ADMIN> 
login delay <seconds-10> 
login on-success log 
login on-failure log 
security authentication failure rate <threshold-1024> log 
! 
ip domain-name <website name> 
crypto key generate rsa general-keys modulus <num-1024>  
ip ssh version 2 
ip ssh time-out <num-60> 
ip ssh authentication-retries <num-2> 
! 
logging host <ip address of server- connected to ML1- 192.168.10.2 >
logging trap <level> 
logging source-int <int-id> 
logging on 
! 
no cdp run 
! 
aaa new-model  
radius server <name-SERVER-R> 
address ipv4 <ip address of server- 192.168.0.2> auth-port 1812 acct-port 1813 
key <password-RADPASS> 
exit 
aaa group server radius <name-radius_group> 
server name <SERVER-R> 
aaa local authentication attempts max-fail <num-3> 
aaa authentication login default group <radius_group> local  
aaa authorization exec default group <radius_group> local 
aaa authorization network default group <radius_group> local 
aaa accounting exec default start-stop group <radius_group> 
aaa accounting network default start-stop group <radius_group> 
! 
zone security <name-INSIDE> 
exit 
class-map type inspect match-any <name-INSIDE_PROTOCOLS> 
match protocol <p-tcp> 
match protocol <p-udp> 
match protocol <p-icmp> 
match protocol <p-https> 
match protocol <p-ssh> 
exit 
zone security <name-INTERNET> 
! 
policy-map type inspect <map-INSIDE_TO_INTERNET> 
class type inspect <name-INSIDE_PROTOCOLS> 
inspect 
! 
zone-pair security <map-INSIDE_TO_INTERNET> source <INSIDE> destination <INTERNET> 
service-policy type inspect <map-INSIDE_TO_INTERNET> 
exit 
zone-pair security <map-INSIDE_TO_INTERNET> source <INTERNET> destination <INSIDE> 
exit 
exit 
!-zone pair may be incorrect in gns3!!! 
fhrp version vrrp v3 
secure boot-image 
secure boot-config 
exit 
copy ru st 
! 
interface g0/0 
ip address <public ip address> <subnet mask> 
vrrp <num-10> address-family ipv4 
address <virtual ip address>      
track <num-1> decrement <num-20> 
priority <num-110> 
track <num-1> decrement <num-20> 
exit 
ipv6 enable 
ipv6 address <public ipv6 address/prefix>  
ipv6 address <ipv6 local address> link-local 
vrrp <num-20> address-family ipv6 
address <virtual ipv6 address>      
track <num-2> decrement <num-20> 
priority <num-110> 
track <num-2> decrement <num-20> 
exit 
ip nat outside 
zone-member security <name-INTERNET> 
crypto map <name-CMAP>- NOTE- ipsec needs to be configured first for this int cmd to wrk 
no shutdown 
! 
interface g0/1 
ip address <private ip address> <subnet mask> 
ipv6 enable 
ipv6 address <private ipv6 address/prefix list>  
ipv6 address <ipv6 local address> link-local 
ospfv3 <number> ipv4 area <as-num> 
ospfv3 <number> ipv6 area <as-num> 
ospfv3 encryption ipsec spi <num-1000> esp <null> sha1 <40-digit number> 
ip nat inside 
zone-member security <name-INSIDE> 
no shutdown 
! 
int g0/2 
ip address <private ip address> <subnet mask> 
ipv6 enable 
ipv6 address <private ipv6 address/prefix list>  
ipv6 address <ipv6 local address> link-local 
ospfv3 <number> ipv4 area <as-num> 
ospfv3 <number> ipv6 area <as-num> 
ospfv3 encryption ipsec spi <num-1000> esp <null> sha1 <same-40-digit number> 
ip nat inside 
zone-member security <name-INSIDE> 
no shutdown 
!
interface loopback 1 NOTE- different per R router 
ip address <loopback_ip_address-192.168.1.1> <subnet-mask- 255.255.255.255> 
ipv6 enable 
ospfv3 <number> ipv4 area <as-num> 
! 
ip nat pool <name> <start public address> <end public address> netmask <subnet>  
access-list <number> permit <private network address> <wildcard-mask> 
ip nat inside source list <number> pool <name> 
! 
router ospfv3 <number> 
address-family ipv4 unicast 
router-id <id-num> 
redistribute connected 
exit 
address-family ipv6 unicast 
router-id <id-num> 
redistribute connected 
exit 
exit 
! 
ip route <WAN-Loopback-network> <subnet-mask> <next-hop-WAN-int-ip-address> 
ip route <R-opposite-Loopback-network> <subnet-mask> <next-hop-R-int-ip-address> 
! 
ip bgp-community new-format 
route-map <name-NO-EXPORT> 
set community no-export 
! 
router bgp <number> NOTE- AS numbers will be the same for both internal routers 
bgp router-id <id> 
no bgp default ipv4-unicast 
neighbor <WAN-ip address> remote-as <number> 
neighbor <WAN-ip address> update-source Loopback 1  
neighbor <ipv6 address> remote-as <number> 
address-family ipv4 
neighbor <ipv4 address> activate 
network <network address> mask <subnet mask> 
redistribute connected 
neighbor <WAN-ip address> route-map <name-NO-EXPORT> in 
neighbor <WAN-ip address> send-community 
neighbor <ip address of WAN> route-map <name-AS10> out 
exit 
address-family ipv6 
neighbor <ipv6 address> activate 
network <network address/prefix> 
redistribute connected 
neighbor <WAN-ip address> route-map <name-NO-EXPORT> in 
neighbor <WAN-ip address> send-community 
exit 
! 
crypto isakmp enable 
crypto isakmp policy <num-10> 
hash sha 
authentication pre-share 
group 14 
lifetime 3600 
encryption aes 256 
exit 
crypto isakmp key <password-keyacc101> address <remote peer ip adress of WAN-1> 
crypto ipsec transform-set <tag-50> esp-aes 256 esp-sha-hmac 
exit 
crypto ipsec security-association lifetime seconds 3600 
access-list <num-101> permit ip <ip address range of accepted addresses (must suit our addressing scheme)-192.168.1.0 0.0.0.255 192.168.3.0 0.0.0.255> 
crypto map <name-CMAP> <num-10> ipsec-isakmp 
match address <acl num-101> 
set peer <WAN-1 peer address> 
set pfs group14 
set transform-set <num-50> 
set security-association lifetime seconds <num-900> 
exit 
!
crypto isakmp policy <num-15> 
authentication pre-share 
hash sha 
group 2
encryption aes 256 
lifetime 3600 
exit
crypto isakmp key <password> address ipv6 <ipv6-address/prefix> 
crypto keyring <name-keyring> 
pre-shared-key address ipv6 <ipv6-address/prefix> key 6 <password-ringpass> 
exit 
crypto ipsec transform-set <name-sercset1> <set> esp-aes 256 esp-sha-hmac 
mode tunnel 
exit 
crypto ipsec profile <name-profile0> 
set transform-set <name-sercset1> 
exit 
crypto isakmp profile <name-profile1> 
self-identify address ipv6 
match identity address ipv6 <WAN-ipv6-address/prefix> 
keyring default 
exit 
interface tunnel <num-1> 
ipv6 address @tunnel_ipv6_add eui-64 
ipv6 enable 
tunnel source @tunnel_source_interface
tunnel destination @tunnel_destination_address
tunnel mode ipsec ipv6 
tunnel protection ipsec profile @tunnel_protection_profile
end 
! 
clock set @current_time
! 
ntp peer ntp_peer_add
ntp master @ntp_master_num
ntp authenticate 
ntp authentication-key @ntp_auth_key_num md5 @ntp_auth_key_pass
ntp trusted-key @ntp_trust_key
!   
ip prefix-list @ip_prefix_list_name permit @ip_prefix_list_network
! 
route-map @route_map_name permit @route_map_permit_1
match ip address prefix-list @route_map_match_list 
set weight @set_weight
set metric @set_metric
exit 
route-map @route_map_name permit @route_map_permit_2
! 